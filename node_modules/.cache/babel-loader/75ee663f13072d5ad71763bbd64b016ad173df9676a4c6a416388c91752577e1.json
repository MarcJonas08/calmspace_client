{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\diazm\\\\Desktop\\\\calmspace - react\\\\calmspace\\\\src\\\\context\\\\AdminAuthContext.js\",\n  _s = $RefreshSig$();\n// AdminAuthContext.js\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AdminAuthContext = /*#__PURE__*/createContext();\nexport default AdminAuthContext;\nexport const AdminAuthProvider = ({\n  children\n}) => {\n  _s();\n  const navigate = useNavigate();\n  const [adminAuthTokens, setAdminAuthTokens] = useState(() => localStorage.getItem('adminAuthTokens') ? JSON.parse(localStorage.getItem('adminAuthTokens')) : null);\n  const [adminUser, setAdminUser] = useState(() => localStorage.getItem('adminAuthTokens') ? jwtDecode(localStorage.getItem('adminAuthTokens')) : null);\n  const [loading, setLoading] = useState(true);\n  const adminLogin = async event => {\n    event.preventDefault();\n    const response = await fetch('http://127.0.0.1:8000/admin-api/token/', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        'username': event.target.username.value,\n        'password': event.target.password.value\n      })\n    });\n    const data = await response.json();\n    if (response.status === 200) {\n      setAdminAuthTokens(data);\n      setAdminUser(jwtDecode(data.access));\n      localStorage.setItem('adminAuthTokens', JSON.stringify(data));\n      navigate('/admin');\n      console.log('ADMIN USER: ', adminAuthTokens);\n    } else {\n      alert('Invalid username or password');\n    }\n  };\n  const handleAdminLogout = () => {\n    setAdminAuthTokens(null);\n    setAdminUser(null);\n    localStorage.removeItem('adminAuthTokens');\n    navigate('/admin-login');\n  };\n  let updateAdminToken = async () => {\n    console.log('Updating admin token');\n    const response = await fetch('http://127.0.0.1:8000/admin-api/token/refresh/', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        'refresh': adminAuthTokens === null || adminAuthTokens === void 0 ? void 0 : adminAuthTokens.refresh\n      })\n    });\n    const data = await response.json();\n    if (response.status === 200) {\n      setAdminAuthTokens(data);\n      setAdminUser(jwtDecode(data.access));\n      localStorage.setItem('adminAuthTokens', JSON.stringify(data));\n    } else {\n      handleAdminLogout();\n    }\n    setLoading(false);\n  };\n  useEffect(() => {\n    if (loading) {\n      updateAdminToken();\n    }\n    let fourMinutes = 1000 * 60 * 4;\n    let interval = setInterval(() => {\n      if (adminAuthTokens) {\n        updateAdminToken();\n      }\n    }, fourMinutes);\n    return () => clearInterval(interval);\n  }, [adminAuthTokens, loading]);\n  const adminContextData = {\n    adminUser: adminUser,\n    adminLogin: adminLogin,\n    setAdminUser: setAdminUser,\n    setAdminAuthTokens: setAdminAuthTokens,\n    handleAdminLogout: handleAdminLogout\n  };\n  return /*#__PURE__*/_jsxDEV(AdminAuthContext.Provider, {\n    value: adminContextData,\n    children: loading ? null : children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n};\n_s(AdminAuthProvider, \"q7qlMQqD16jEDgT3CIwinbVM1Uw=\", false, function () {\n  return [useNavigate];\n});\n_c = AdminAuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AdminAuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","jwtDecode","useNavigate","jsxDEV","_jsxDEV","AdminAuthContext","AdminAuthProvider","children","_s","navigate","adminAuthTokens","setAdminAuthTokens","localStorage","getItem","JSON","parse","adminUser","setAdminUser","loading","setLoading","adminLogin","event","preventDefault","response","fetch","method","headers","body","stringify","target","username","value","password","data","json","status","access","setItem","console","log","alert","handleAdminLogout","removeItem","updateAdminToken","refresh","fourMinutes","interval","setInterval","clearInterval","adminContextData","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/diazm/Desktop/calmspace - react/calmspace/src/context/AdminAuthContext.js"],"sourcesContent":["// AdminAuthContext.js\r\nimport React, { createContext, useState, useEffect } from \"react\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst AdminAuthContext = createContext();\r\n\r\nexport default AdminAuthContext;\r\n\r\nexport const AdminAuthProvider = ({ children }) => {\r\n  const navigate = useNavigate();\r\n\r\n  const [adminAuthTokens, setAdminAuthTokens] = useState(() =>\r\n    localStorage.getItem('adminAuthTokens')\r\n      ? JSON.parse(localStorage.getItem('adminAuthTokens'))\r\n      : null\r\n  );\r\n\r\n  const [adminUser, setAdminUser] = useState(() =>\r\n    localStorage.getItem('adminAuthTokens')\r\n      ? jwtDecode(localStorage.getItem('adminAuthTokens'))\r\n      : null\r\n  );\r\n\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const adminLogin = async (event) => {\r\n    event.preventDefault();\r\n\r\n    const response = await fetch('http://127.0.0.1:8000/admin-api/token/', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        'username': event.target.username.value,\r\n        'password': event.target.password.value,\r\n      }),\r\n    });\r\n\r\n    const data = await response.json();\r\n\r\n    if (response.status === 200) {\r\n      setAdminAuthTokens(data);\r\n      setAdminUser(jwtDecode(data.access));\r\n      localStorage.setItem('adminAuthTokens', JSON.stringify(data));\r\n\r\n      navigate('/admin');\r\n      console.log('ADMIN USER: ', adminAuthTokens);\r\n    } else {\r\n      alert('Invalid username or password');\r\n    }\r\n  };\r\n\r\n  const handleAdminLogout = () => {\r\n    setAdminAuthTokens(null);\r\n    setAdminUser(null);\r\n    localStorage.removeItem('adminAuthTokens');\r\n\r\n    navigate('/admin-login');\r\n  };\r\n\r\n  let updateAdminToken = async () => {\r\n    console.log('Updating admin token');\r\n    const response = await fetch(\r\n      'http://127.0.0.1:8000/admin-api/token/refresh/',\r\n      {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({'refresh': adminAuthTokens?.refresh}),\r\n      }\r\n    );\r\n\r\n    const data = await response.json();\r\n\r\n    if (response.status === 200) {\r\n      setAdminAuthTokens(data);\r\n      setAdminUser(jwtDecode(data.access));\r\n      localStorage.setItem('adminAuthTokens', JSON.stringify(data));\r\n    } else {\r\n      handleAdminLogout();\r\n    }\r\n\r\n    setLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (loading) {\r\n      updateAdminToken();\r\n    }\r\n\r\n    let fourMinutes = 1000 * 60 * 4;\r\n    let interval = setInterval(() => {\r\n      if (adminAuthTokens) {\r\n        updateAdminToken();\r\n      }\r\n    }, fourMinutes);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [adminAuthTokens, loading]);\r\n\r\n  const adminContextData = {\r\n    adminUser: adminUser,\r\n    adminLogin: adminLogin,\r\n    setAdminUser: setAdminUser,\r\n    setAdminAuthTokens: setAdminAuthTokens,\r\n    handleAdminLogout: handleAdminLogout,\r\n  };\r\n\r\n  return (\r\n    <AdminAuthContext.Provider value={adminContextData}>\r\n      {loading ? null : children}\r\n    </AdminAuthContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}